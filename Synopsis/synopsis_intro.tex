\section*{General description of work} 


\subsection*{Background}


The rapid advancements in Deep Learning (DL) have established a strong foundation for automating medical image segmentation tasks~\cite{lee2017deep}. Segmentation algorithms, particularly those based on Convolutional Neural Networks (CNNs), have achieved near human-level performance across a variety of clinical applications, including brain tumor, lung cancer, organ-at-risk, and liver tumor segmentation. These algorithms continue to evolve, offering increasingly accurate results.

%In our previous work, we have demonstrated the practical impact of carefully developed DL methods in real clinical workflows. For instance, we contributed to the radiotherapeutic delineation process at the Moscow Gamma-Knife Center by developing a model that provides accurate brain metastases segmentation contours~\cite{shirokikh2022systematic}. Additionally, our work on automatic COVID-19 identification and severity triage has been successfully integrated into the Moscow healthcare system, streamlining patient management~\cite{goncharov2021ct,covid-program}.

Despite this progress, the widespread deployment of CNN-based segmentation models in clinical practice remains significantly constrained. A central limitation is the lack of model robustness under domain shift -- a phenomenon where systematic differences in data distribution arise due to variation in scanner vendors, acquisition protocols, reconstruction algorithms, patient populations, or healthcare institutions. When a model trained on one data domain is evaluated on a different domain, even without any semantic changes, its performance often degrades dramatically. In medical imaging, this effect has been documented across multiple modalities, including Magnetic Resonance Imaging (MRI) and Computed Tomography (CT), and across various tasks such as brain tissue, tumor, and COVID-19 lesion segmentation~\cite{shirokikh2020first,zakazov2021anatomy,saparov2021zero,shimovolos2022adaptation}.

To address this issue, domain adaptation (DA) methods have been actively explored. DA focuses on transferring knowledge from a labeled source domain to an unlabeled or differently-distributed target domain. Although numerous DA techniques have been proposed specifically in medical imaging~\cite{gulrajani2020search,uda_survey_2020,zhuang2020comprehensive,peng2018visda,zhang2021empirical}, most methods are validated under narrow experimental settings that do not fully reflect the diversity and complexity of real clinical scenarios. Specifically, the medical imaging datasets used are often either private, too small for robust training and evaluation, or limited to a single domain shift source or synthetic task. Moreover, methods addressing severe and frequently encountered in practice domain shifts, such as varying reconstruction kernels in CT, are mostly ignored and underdeveloped.

Therefore, the field of medical image segmentation urgently requires domain adaptation techniques that are effective under realistic domain shifts, scalable to large 3D datasets, and rigorously evaluated in clinically representative conditions. This dissertation addresses these needs through the development of novel DA methods, introduction of robust evaluation benchmarks, and publication of heterogeneous datasets, with the overarching goal of enabling safe, accurate, and generalizable deployment of deep learning models in clinical medical imaging workflows.


\subsection*{Relevance of the work}

The research presented in this dissertation addresses an impactful problem in the field of artificial intelligence and medical imaging: the lack of robustness and generalization of deep learning models under domain shift. Despite remarkable progress in developing CNNs for medical image segmentation, their deployment in real-world clinical environments remains limited due to the sharp degradation in performance when data characteristics change, such as those caused by differences in scanner hardware, acquisition protocols, or reconstruction algorithms. This issue is particularly acute in 3D medical imaging, where annotated data is scarce and domain variability is high.

This thesis focuses on the development and evaluation of domain adaptation methods for 3D segmentation models. The developed methods, including SpotTUnet, FBPAug, and F-Consistency, demonstrate strong potential for improving the robustness of medical segmentation models across diverse imaging protocols and clinical environments. The introduced M3DA and OOD detection benchmarks provide systematic tools for evaluating domain adaptation and reliability of segmentation algorithms in real-world scenarios. Furthermore, the published Burdenko Glioblastoma Progression dataset offers a clinically relevant testbed for developing and validating domain adaptation methods in radiotherapy planning. Altogether, the results of this dissertation contribute to advancing the safe deployment of deep learning in clinical practice and help bridge the gap between algorithmic development and medical application. This research contributes to the methodological foundations of deep learning in healthcare by enhancing the adaptability and reliability of medical image segmentation models.


\subsection*{Dissertation goals}

This research is devoted to the development of robust DL methods for 3D medical image segmentation under domain shift. The work focuses on both algorithmic contributions to supervised and unsupervised DA, and on establishing standardized benchmarks and datasets to support realistic evaluation of generalization in medical imaging. The results are demonstrated on clinically relevant segmentation tasks using MRI and CT data.
To achieve this goal, the following tasks were set up and performed:

\begin{enumerate}
    \item Domain Shift Analysis in MRI and CT: Estimate the sensitivity of segmentation models to different sources of domain shift in MRI and CT images. Identify CNN layers most affected by domain shift and propose a strategies for automatic layer selection and interpretable domain adaptation.
    \item Development of DA Algorithms: Design a physics-informed augmentation method to simulate CT kernel-induced shift. Develop a data-driven unsupervised adaptation method based on enforcing feature map similarity between paired CT images. Implement and evaluate supervised and unsupervised adaptation pipelines in low-data and zero-shot settings.
    \item Benchmarking Robustness in 3D Medical Imaging at Scale: Construct a realistic and large-scale benchmark to systematically assess DA performance across varied domain shift scenarios in MRI and CT segmentation tasks. Collect and release a clinically realistic dataset -- a large-scale, annotated collection from multiple clinical centers and scanner vendors. Assess generalization of segmentation models under heterogeneous real-world conditions and evaluate state-of-the-art DA methods, reporting their limitations. Develop an OOD benchmark with several clinically relevant test cases and evaluate standard methods. % glioblastoma MRI collection
\end{enumerate}


% TODO: do we need newpage here?
%\newpage


\subsection*{Propositions for defense}

\begin{enumerate}
	
	\item A supervised DA method, SpotTUnet, is proposed for layer-wise adaptation in convolutional neural networks. The method automatically identifies and fine-tunes the layers most affected by domain shift using a proposed gradient-based approach for learning a layer selection policy. SpotTUnet also provides an interpretable visualization of domain shift sensitivity across network layers due to the proposed regularization criterion, contributing to theoretical understanding of neural network model generalization under domain shift.
	
	% \item A knowledge-driven augmentation technique, Filtered Back-Projection Augmentation (FBPAug), is developed to simulate domain shifts induced by variation in CT reconstruction kernels. The method is theoretically grounded in the mathematical model of CT image formation and mimics kernel-induced transformations in the sinogram space, resulting in controlled variation of image noise, resolution, and texture. Furthermore, an unsupervised DA method, F-Consistency, is proposed to exploit unlabeled paired CT images reconstructed with different kernels. It enforces similarity of intermediate feature representations by minimizing the mean squared error between corresponding feature maps. Empirical evaluation confirms that the proposed methods significantly improve segmentation accuracy, including a Dice score increase in COVID-19 lung segmentation and other clinically relevant tasks.
	
	\item A knowledge-driven augmentation technique, Filtered Back-Projection Augmentation (FBPAug), is developed to simulate domain shift induced by variation in CT reconstruction kernels. The method is theoretically grounded in the mathematical model of CT image acquisition and simulates kernel-induced transformations in the sinogram space, enabling controlled variation of image noise, resolution, and texture. Furthermore, an unsupervised DA method, F-Consistency, is proposed to leverage unlabeled paired CT images reconstructed with different kernels. The method enforces similarity of internal feature representations by minimizing the mean squared error between feature maps of corresponding images. Empirical evaluation confirms that the proposed methods significantly improve segmentation accuracy, including a Dice score increase in COVID-19 segmentation and other clinically relevant tasks.
    
    \item A large-scale benchmark, M3DA, is developed for the systematic evaluation of unsupervised DA methods in 3D medical image segmentation. A clinically realistic dataset, Burdenko’s Glioblastoma Progression (BGP), is collected and published to enable in-the-wild evaluation of segmentation models under heterogeneous MRI acquisition conditions. Additionally, a benchmark for OOD detection in 3D medical image segmentation is proposed, containing several clinically relevant challenge scenarios. These benchmarks provide a rigorous empirical basis for studying generalization and robustness of segmentation algorithms under real-world distributional variability.
 
\end{enumerate}


\subsection*{Scientific novelty}

% It seems that statements to defend can very much overlap with the sci novelty, at least in some examples they do.
The scientific novelty is built up from the following results:

\begin{enumerate}
    
    \item A novel gradient-based method, SpotTUnet, is proposed and implemented to automatically identify and fine-tune the neural network layers most susceptible to domain shifts in supervised DA settings, improving segmentation performance under limited data availability.
    
    \item A knowledge-driven augmentation technique, FBPAug, is developed for the first time to simulate the effect of CT reconstruction kernel variability, significantly improving segmentation consistency.
    
    \item A data-driven unsupervised domain adaptation method, F-Consistency, is developed for the first time to address CT reconstruction kernel variability by enforcing feature map similarity between paired images. The method achieves state-of-the-art performance under kernel-induced domain shifts and establishes a foundation for future self-supervised learning approaches using FBPAug-generated pairs and the F-Consistency criterion.
    
    \item A large-scale benchmark, M3DA, was introduced for evaluating unsupervised domain adaptation methods in 3D medical image segmentation, revealing critical limitations of existing approaches -- none of which close more than 61\% of the performance gap between source and target domains.
    
    \item A new publicly available dataset for primary glioblastoma segmentation in radiotherapy planning is collected and published. It allows for testing domain adaptation methods in the close to clinical scenarios.
    
    \item A benchmark for out-of-distribution detection in 3D medical imaging is constructed for the first time, containing multiple challenge scenarios and exposing critical limitations of existing OOD detection methods.
    
\end{enumerate}


\subsection*{Theoretical and practical significance}

From a theoretical perspective, the dissertation contributes novel formulations and learning principles for domain adaptation in 3D medical image segmentation. The proposed SpotTUnet method introduces a gradient-based criterion for identifying domain-shift-sensitive layers in CNNs, offering new insights into the structural behavior of deep models under distributional shift. The FBPAug method is grounded in the mathematics of computed tomography, providing a parametrically controlled augmentation technique to simulate domain shifts caused by reconstruction kernels. F-Consistency formulates an unsupervised learning objective based on the similarity of internal representations, establishing a principled approach for leveraging paired but unlabeled data. These developments enrich the foundations of machine learning, domain adaptation in particular, and support further study into robustness and model generalization.

On the practical side, the proposed methods have been shown to significantly improve segmentation robustness under clinically relevant domain shifts, including those caused by acquisition parameters, reconstruction algorithms, and institutional variability. The developed M3DA benchmark provides a comprehensive framework for empirical evaluation of DA algorithms, while the published BGP dataset enables realistic testing in radiotherapy planning scenarios. Additionally, the OOD detection benchmark and the IHF method contribute to building reliable diagnostic pipelines capable of identifying OOD inputs in practice. %Collectively, the results of this research support safer and more generalizable deployment of deep learning models in real-world medical imaging workflows, bridging the gap between theoretical advancements and clinical applicability.

%Classification of quantum phases by quantum means is potentially useful for condensed matter physics. The results on the convergence of VQE are important for the design of quantum optimization algorithms. The proposed method for validating the GHZ state is potentially useful for evaluating the properties of quantum devices in a simple manner.
%Practical significance of the work is supported by the usage of the results in delivering the RFBR grant No.\ 19-31-90159 ``Aspiranty''.


\subsection*{Research methodology}

The research employs machine learning and deep learning techniques to improve the generalization and robustness of CNNs in 3D medical image segmentation, focusing on both supervised and unsupervised learning paradigms. Methodologically, the work integrates tools from linear algebra, probability theory, mathematical statistics, and numerical optimization to develop and analyze domain adaptation algorithms.

Experimental evaluation relies on large-scale empirical studies using publicly available and newly introduced benchmarks and datasets. All methods are implemented in the Python programming language using established DL frameworks. Software components were designed for reproducibility and extensibility, supporting broader use in medical image analysis. Clinical relevance and task formulation were refined through collaboration with medical experts in radiology and radiation oncology.


\subsection*{The reliability}

The reliability of the results is ensured by comprehensive experimental evaluation across multiple datasets, diverse experimental settings, and multiple methods of statistical analysis, with all validation procedures in accordance with the leading work in the area. The reproducibility of findings was validated through systematic benchmarking of multiple deep learning algorithms and repeated experiments to ensure statistical significance of the results. Finally, all the proposed methods are compared with existing state-of-the-art using a broad set of metrics.

The statements and conclusions formulated in the dissertation have received qualified approbation at international and Russian conferences. The credibility is also confirmed by two publications of research results in Q1 peer-reviewed scientific journals, two publications in Q2 peer-reviewed journals, and three peer-reviewed conference proceedings, including one in proceedings of the Rank A conference -- all being WoS, Scopus indexed.
%Предложенные наборыданных были опубликованы.


\subsection*{Validation of the research results}

The main results of the work have been reported in the following scientific conferences and workshops:

\begin{enumerate}
    \item Domain Adaptation and Representation Transfer MICCAI 2020 Workshop. Lima, Peru, October 2020.
    \item Cross-Modality Domain Adaptation for Medical Image Segmentation (challenge-associated satellite event at MICCAI). Strasbourg, France, September 2021.
    \item Conference on Medical Image Computing and Computer Assisted Intervention (MICCAI). Strasbourg, France, September 2021.
    \item Information Technologies and Systems (ITaS) conference. Moscow, Russia, November 2021.
    \item Medical Out-of-Distribution Analysis Challenge (challenge-associated satellite event at MICCAI). Singapore, September 2022.
    \item Information Technologies and Systems (ITaS) conference. Istra, Russia, September 2023.
\end{enumerate}


\subsection*{Personal contribution}

All the results of the dissertation were obtained personally by the applicant or with his direct involvement. In particular, the applicant’s contribution includes setting research objectives, studying literature corresponding to the topic, designing and conducting extensive experiments, and analyzing the received results. The applicant, together with Dr. Mikhail Belyaev and the scientific supervisor, Prof. Ivan Oseledets, participated in the formulation of the dissertation aims and objectives. Discussion of the results and preparation for publication of these results were carried out jointly with co-authors.


\subsection*{Structure and volume of the dissertation} The dissertation consists of introduction, four chapters, conclusions, bibliography, list of symbols and abbreviations, list of tables, list of figures, list of 165 references. The full 
volume of the dissertation is 126 pages, including 26 figures and 18 tables.